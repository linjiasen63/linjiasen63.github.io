<!doctype html><html class=theme-light><head lang=zh-cn><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=description content="生活足迹"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=keyword content><link rel="shortcut icon" href=/image/favicon.ico type=image/x-icon></link><title>性能优化：前端能够做哪些事情？</title><link rel=canonical href=/><link href=/scss/index.min.d29e17271260ef8a7c5ed760e4e077c3321b47959ac90b2002d51293b11cd381.css rel=stylesheet><script type=text/javascript src=/js/jquery.min.js></script><link rel=stylesheet href=/gitalk/gitalk.css><script src=/gitalk/gitalk.min.js></script></head><body><header class=site-header><div class=site-wrapper><nav class=site-navbar><a class=site-navbar-brand href=/>林三木</a><div class=site-navbar-menu onclick=toggleNavbarmenu(this)><div class=icon></div></div><div class=site-navbar-collapse id=site-navbarText onclick=toggleNavbarmenu(this)><span class="site-navbar-text none"></span><ul class=site-navbar-nav><li class=nav-item><a class=nav-link href=/archives.html>归档</a></li><li class=nav-item><a class=nav-link href=/about.html>我的</a></li><li class=nav-item><a class=nav-link href=/>首页</a></li></ul></div></nav><script>function toggleNavbarmenu(c){var a=$(c).parent(),b='site-navbar-open';a.hasClass(b)?a.removeClass(b):a.addClass(b)}</script></div></header><div class=site-body><div class="site-wrapper clearfix"><main class=site-main><div class=site-main-wrapper><div class=single-post><div><article id=content class=md-render><h1 id=title class=title>性能优化：前端能够做哪些事情？</h1><h2>目录</h2><nav id=TableOfContents><ul><li><a href=#1概述>1.概述</a></li><li><a href=#2-更快速的网络通信>2. 更快速的网络通信</a><ul><li><a href=#21-服务器通信层面cdn>2.1 服务器通信层面（CDN）</a></li><li><a href=#22-服务器通信层面请求次数>2.2 服务器通信层面（请求次数）</a></li><li><a href=#23-数据传输层面缓存>2.3 数据传输层面（缓存）</a></li><li><a href=#24-数据传输层面压缩>2.4 数据传输层面（压缩）</a></li><li><a href=#25-通信协议层面http2>2.5 通信协议层面（HTTP2）</a></li></ul></li><li><a href=#3-更高效的数据处理>3. 更高效的数据处理</a><ul><li><a href=#31-性能分析工具的使用>3.1 性能分析工具的使用</a></li><li><a href=#32-前端代码层面>3.2 前端代码层面</a></li><li><a href=#33-服务端渲染ssr>3.3 服务端渲染（SSR）</a></li><li><a href=#34-静态站点生成方案ssg>3.4 静态站点生成方案（SSG）</a></li></ul></li></ul></nav><h2 id=1概述>1.概述</h2><p><img src=https://raw.githubusercontent.com/linjiasen63/static-resources/master/images/20210402065334.png alt=时序图 title></p><h2 id=2-更快速的网络通信>2. 更快速的网络通信</h2><h3 id=21-服务器通信层面cdn>2.1 服务器通信层面（CDN）</h3><p>content delivery network: 内容分发网络</p><p>其底层实现技术为</p><h4 id=211-全局负载均衡>2.1.1 全局负载均衡</h4><p>根据以下因素进行智能调度</p><ul><li>地理位置</li><li>负载情况</li></ul><h4 id=212-缓存系统>2.1.2 缓存系统</h4><ul><li>命中率（在从服务器中能查找到资源）</li><li>回源率（在从服务器中查找不到，到主服务器中去查找）</li></ul><p>只需要更新主服务器的资源，从服务器根据某些规则更新资源。</p><p>命中率越高越好、回源率越低越好</p><p>回源率一般不超过5%，若超过需要好好考虑下。</p><h3 id=22-服务器通信层面请求次数>2.2 服务器通信层面（请求次数）</h3><ul><li>资源合并（减少连接创建次数）<ul><li>雪碧图（不利于缓存）</li></ul></li><li>域名分片（浏览器对请求并发的限制）<ul><li>多域名</li></ul></li></ul><p>早期的规范一个域名最多并发两个连接；但在浏览器实现时一般是6~8（chrome为6个，firefox为8个），在后续标准中去掉限制。</p><p>资源合并在http2中可能出现负作用。</p><h3 id=23-数据传输层面缓存>2.3 数据传输层面（缓存）</h3><ul><li>强缓存（由于浏览器兼容性，一般同时返回客户端）<ul><li>&lt;- cache-control: max-age=600（优先级更高）<ul><li>从服务器发出时开始计时，单位是秒</li></ul></li><li>&lt;- expires: Mon, 14 Setp 2020 09:20:20 GMT</li></ul></li><li>协商缓存<ul><li>&lt;- last-modified: Thu, 01 Apr 2021 22:54:58 GMT</li><li>-> if-modified-since: Thu, 01 Apr 2021 22:54:58 GMT</li><li>&lt;- etag: W/&ldquo;75a11da44c802486bc6f65640aa48a73&rdquo;</li><li>-> if-none-match: W/&ldquo;75a11da44c802486bc6f65640aa48a73&rdquo;</li></ul></li></ul><h3 id=24-数据传输层面压缩>2.4 数据传输层面（压缩）</h3><ul><li>数据压缩<ul><li>gzip 与 新的br</li></ul></li><li>代码文件压缩<ul><li>HTML/CSS/JS中的注释、空格、长变量名等等</li></ul></li><li>静态资源<ul><li>字体图标、去除元数据（如手机拍摄的图片携带的其它信息，如地理位置、光圈等）、缩小尺寸及分辨率，使用jpg或者webp格式</li></ul></li><li>头与报文<ul><li>http1.1 中减少不必要的头</li><li>减少cookie数据量</li></ul></li></ul><h3 id=25-通信协议层面http2>2.5 通信协议层面（HTTP2）</h3><p>测试网站
http2.akamai.com/demo</p><p>资源合并和域名分片最好不要做</p><h4 id=251-htptp2-头部压缩>2.5.1 HTPTP2 头部压缩</h4><ul><li>臃仲的请求头：平均460字节的首部</li><li>专门的HPACK压缩算法<ul><li>索引表</li><li>霍夫曼编码</li></ul></li></ul><p>索引表：客户端和服务端一起维护，类似map</p><h4 id=252-http2-二进制帧>2.5.2 HTTP2 二进制帧</h4><ul><li>文本字符分割的数据流<ul><li>解析慢且容易出错</li></ul></li><li>二进制帧<ul><li>帧长度</li><li>帧类型</li><li>帧标识</li></ul></li></ul><h4 id=253-http2-链路复用>2.5.3 HTTP2 链路复用</h4><p>客户端发送请求到服务端，有段等待时间（服务器处理数据），此时链路是空闲的（空档）。</p><h2 id=3-更高效的数据处理>3. 更高效的数据处理</h2><h3 id=31-性能分析工具的使用>3.1 性能分析工具的使用</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:green># ab -c${客户端数} -n${客户端发送数量} -t${总的请求时间，单位秒} ${url地址}</span>
ab -c100 -n10 -t3 http://127.0.0.1:8001/
</code></pre></div><p>qps： 每秒能承载的并发量，一秒能支持多少次请求
qps： 每秒能承载的并发量，一秒能支持多少次请求</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>node --prof <span style=color:#a31515>${</span>启动文件<span style=color:#a31515>}</span>
<span style=color:green># 会生成文件isolate-xxx.log</span>
node --prof-process <span style=color:#a31515>${</span>isolate文件<span style=color:#a31515>}</span> &gt; profile.txt
</code></pre></div><h3 id=32-前端代码层面>3.2 前端代码层面</h3><ul><li>HTML 语义化标签加强DOM解析</li><li>多使用伪元素，减少JS多DOM的查找遍历</li><li>能用HTML/CSS实现的效果就不要用JS</li><li>逻辑与展示解耦，避免不必要的JS引擎启动</li><li>减少作用域查找和闭包，避免==，使用块级作用域</li></ul><h3 id=33-服务端渲染ssr>3.3 服务端渲染（SSR）</h3><p>客户端渲染 CSR</p><ul><li>白屏时间长，用户体验不好</li><li>HTML无内容，不利于SEO</li></ul><h3 id=34-静态站点生成方案ssg>3.4 静态站点生成方案（SSG）</h3><p>static site generate</p><ul><li>专门的SSG方案（框架）<ul><li>Gatsby</li><li>Gridsome</li></ul></li><li>副业实现<ul><li>next.js</li><li>nuxt.js</li></ul></li></ul></article></div><div class=pagination-single><div class=btn>上一篇：<a class=previous href=https://linjiasen63.github.io/posts/programming/base/git/conventional.html>
git基础：规范式提交</a></div><div class=btn>下一篇：<a class=next href=https://linjiasen63.github.io/posts/programming/front/nodejs/basic-usage.html>
前端系列：nodejs入门</a></div></div></div><div id=pageScrollTop class=page-scroll-top><span class=arr></span><span class=txt>顶部</span></div><script>var $pageScrollTop=$("#pageScrollTop");$pageScrollTop.hide(),$pageScrollTop.on('click',function(){$('html,body').animate({scrollTop:'0px'},300)}),$(document).scroll(function(){var a=$(document).scrollTop(),b=$(document).height();a>b*.2?$pageScrollTop.show():$pageScrollTop.hide()})</script></div></main><aside class=site-aside><section class=widget><form id=search action=https://linjiasen63.github.io/search.html method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=wd maxlength=20 placeholder=Search>
<input type=hidden name=sitesearch value=https://linjiasen63.github.io>
<button type=submit class="submit icon-search">搜索</button></form></section><section class=widget><h3 class=widget-title><a href=/>最新内容</a></h3><ul class=widget-list><li><a href=https://linjiasen63.github.io/posts/programming/front/other/form-request.html title=前端系列：浏览器直接常见请求>前端系列：浏览器直接常见请求</a></li><li><a href=https://linjiasen63.github.io/posts/programming/front/midro-front/basic-usgae.html title=前端系列：微前端介绍>前端系列：微前端介绍</a></li><li><a href=https://linjiasen63.github.io/posts/programming/front/nodejs/basic-usage.html title=前端系列：nodejs入门>前端系列：nodejs入门</a></li><li><a href=https://linjiasen63.github.io/posts/programming/perf/front-performance.html title=性能优化：前端能够做哪些事情？>性能优化：前端能够做哪些事情？</a></li><li><a href=https://linjiasen63.github.io/posts/programming/base/git/conventional.html title=git基础：规范式提交>git基础：规范式提交</a></li></ul></section><section class=widget><h3 class=widget-title><a href=/categories.html>内容分类</a></h3><ul class=widget-list><li><a href=https://linjiasen63.github.io/categories/algorithm.html>algorithm</a></li><li><a href=https://linjiasen63.github.io/categories/%E5%B0%8F%E6%95%85%E4%BA%8B.html>小故事</a></li><li><a href=https://linjiasen63.github.io/categories/%E5%B7%A5%E4%BD%9C.html>工作</a></li><li><a href=https://linjiasen63.github.io/categories/%E7%94%9F%E6%B4%BB.html>生活</a></li><li><a href=https://linjiasen63.github.io/categories/%E7%BC%96%E7%A0%81%E4%BA%BA%E7%94%9F.html>编码人生</a></li></ul></section><section class=widget><h3 class=widget-title><a href=/tags.html>内容标签</a></h3><ul class=widget-list><li><a href=https://linjiasen63.github.io/tags/algorithm.html>algorithm</a></li><li><a href=https://linjiasen63.github.io/tags/git.html>git</a></li><li><a href=https://linjiasen63.github.io/tags/java%E5%AD%A6%E4%B9%A0.html>java学习</a></li><li><a href=https://linjiasen63.github.io/tags/%E4%BA%BA%E9%99%85%E5%85%B3%E7%B3%BB.html>人际关系</a></li><li><a href=https://linjiasen63.github.io/tags/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95.html>前端面试</a></li><li><a href=https://linjiasen63.github.io/tags/%E6%8A%80%E8%83%BD.html>技能</a></li></ul></section></aside></div></div><footer class=site-footer><div>&copy; 2021
<a href=https://linjiasen63.github.io>林三木的博客 By linjiasen63</a></div><script type=text/javascript src=/js/mermaid.min.js></script><script>Array.from(document.getElementsByClassName("language-mermaid")).forEach(function(a){a.parentElement.outerHTML=`<div class="mermaid">${a.innerText}</div>`}),mermaid.initialize({startOnLoad:!0}),setTimeout(function(){Array.from(document.getElementsByTagName("polygon")).forEach(function(b){var a=b.attributes.transform.nodeValue;a=a.replace(/\d\d*\.?\d*/ig,function(a){return console.log(a),a+'px'}),console.log(a,$(b)),$(b).css('transform','scaleY(0.68) '+a)})},100)</script><link href=/scss/footer.min.074ed8877e04297a38609ed9ab79872ef47e84798d125aca3e681bea23d211f5.css rel=stylesheet></footer></body></html>